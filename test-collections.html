<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test ProductsCollections System</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2rem; }
        .test-section { margin: 2rem 0; padding: 1rem; border: 1px solid #ddd; border-radius: 8px; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; }
        .product-card { border: 1px solid #ccc; padding: 1rem; border-radius: 4px; }
        .product-image { width: 100%; height: 150px; object-fit: cover; border-radius: 4px; }
        .collection-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem; }
        .collection-card { border: 1px solid #ccc; padding: 1rem; border-radius: 4px; }
        .collection-image { width: 100%; height: 120px; object-fit: cover; border-radius: 4px; }
        .log { background: #f5f5f5; padding: 1rem; border-radius: 4px; font-family: monospace; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>üß™ ProductsCollections System Test</h1>
    
    <div class="test-section">
        <h2>üìä System Status</h2>
        <div id="status">Loading...</div>
    </div>

    <div class="test-section">
        <h2>üìÅ Collections Found</h2>
        <div id="collections-count">Loading...</div>
        <div class="collection-grid" id="collections-grid"></div>
    </div>

    <div class="test-section">
        <h2>üõçÔ∏è Products Found</h2>
        <div id="products-count">Loading...</div>
        <div class="product-grid" id="products-grid"></div>
    </div>

    <div class="test-section">
        <h2>üìù Console Log</h2>
        <div class="log" id="console-log"></div>
    </div>

    <script src="js/collection-scanner.js"></script>
    <script>
        // Capture console logs
        const originalLog = console.log;
        const logDiv = document.getElementById('console-log');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            logDiv.textContent += args.join(' ') + '\n';
            logDiv.scrollTop = logDiv.scrollHeight;
        };

        async function testCollectionsSystem() {
            try {
                document.getElementById('status').textContent = 'üîÑ Testing ProductsCollections system...';
                
                const scanner = new CollectionScanner();
                const data = await scanner.scanCollections();
                
                // Update status
                document.getElementById('status').innerHTML = `
                    ‚úÖ System working!<br>
                    üìÅ Collections: ${data.collections.length}<br>
                    üõçÔ∏è Products: ${data.products.length}
                `;
                
                // Display collections
                document.getElementById('collections-count').textContent = `Found ${data.collections.length} collections:`;
                const collectionsGrid = document.getElementById('collections-grid');
                
                data.collections.forEach(collection => {
                    const card = document.createElement('div');
                    card.className = 'collection-card';
                    card.innerHTML = `
                        <img src="${collection.image}" alt="${collection.name}" class="collection-image" 
                             onerror="this.src='images/collections/collection-oceana.jpg'">
                        <h3>${collection.name}</h3>
                        <p><strong>ID:</strong> ${collection.id}</p>
                        <p>${collection.description}</p>
                    `;
                    collectionsGrid.appendChild(card);
                });
                
                // Display products
                document.getElementById('products-count').textContent = `Found ${data.products.length} products:`;
                const productsGrid = document.getElementById('products-grid');
                
                data.products.forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    card.innerHTML = `
                        <img src="${product.image}" alt="${product.name}" class="product-image">
                        <h4>${product.name}</h4>
                        <p><strong>ID:</strong> ${product.id}</p>
                        <p><strong>Collection:</strong> ${product.collectionName}</p>
                        <p><strong>Material:</strong> ${product.material}</p>
                        <p><strong>Type:</strong> ${product.type}</p>
                        <p><strong>Price:</strong> ‚Ç¨${product.price}</p>
                        <p><strong>Images:</strong> ${product.imageCount}</p>
                        ${product.soldOut ? '<p style="color: red;"><strong>SOLD OUT</strong></p>' : ''}
                    `;
                    productsGrid.appendChild(card);
                });
                
            } catch (error) {
                document.getElementById('status').innerHTML = `‚ùå Error: ${error.message}`;
                console.error('Test failed:', error);
            }
        }

        // Run test when page loads
        testCollectionsSystem();
    </script>
</body>
</html>